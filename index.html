<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Rewards Offer Wall Card Editor</title>
  <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/sortablejs@1.15.0/Sortable.min.js"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link
    href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Poppins:wght@400;500;600;700&display=swap"
    rel="stylesheet">
  <style>
    :root {
      /* Leo design system variables */
      --leo-color-primitive-neutral-98: #fafafb;
      --leo-color-primitive-neutral-100: #ffffff;
      --leo-color-primitive-neutral-90: #e3e3e8;
      --leo-color-primitive-neutral-80: #c7c7cc;
      --leo-color-primitive-neutral-70: #aaaaaf;
      --leo-color-primitive-neutral-60: #909094;
      --leo-color-primitive-neutral-50: #76767a;
      --leo-color-primitive-neutral-40: #5e5e62;
      --leo-color-primitive-neutral-30: #46464a;
      --leo-color-primitive-neutral-20: #303034;
      --leo-color-primitive-neutral-10: #1b1b1f;
      --leo-color-primitive-neutral-5: #111114;
      --leo-color-primitive-primary-40: #434fcf;
      --leo-color-primitive-primary-80: #bdc2ff;
      --leo-color-primitive-primary-90: #e0e0ff;
      --leo-color-primitive-primary-95: #f1efff;
      --leo-font-heading-h1: 700 36px/44px Poppins;
      --leo-font-heading-h2: 600 28px/36px Poppins;
      --leo-font-heading-h3: 600 22px/28px Poppins;
      --leo-font-heading-h4: 600 20px/28px Poppins;
      --leo-font-default-regular: 400 14px/22px Inter;
      --leo-font-default-semibold: 600 14px/22px Inter;
      --leo-font-large-regular: 400 16px/24px Inter;
      --leo-font-large-semibold: 600 16px/24px Inter;
      --leo-font-small-regular: 400 12px/18px Inter;
      --leo-font-small-semibold: 600 12px/18px Inter;
      --leo-font-x-small-regular: 400 11px/16px Inter;
      --leo-radius-l: 12px;
      --leo-radius-xl: 16px;
      --leo-spacing-s: 4px;
      --leo-spacing-m: 8px;
      --leo-spacing-l: 12px;
      --leo-spacing-xl: 16px;
      --leo-spacing-2xl: 24px;
      --leo-effect-elevation-01: 0px 1px 0px 0px rgba(0, 0, 0, 0.05), 0px 1px 4px 0px rgba(0, 0, 0, 0.1);
      --leo-effect-elevation-03: 0px 1px 0px 0px rgba(0, 0, 0, 0.05), 0px 4px 16px -2px rgba(0, 0, 0, 0.1);

      /* Additional Leo variables from stylesheets */
      --leo-color-container-background: var(--leo-color-primitive-neutral-100);
      --leo-color-page-background: var(--leo-color-primitive-neutral-98);
      --leo-color-container-highlight: var(--leo-color-primitive-neutral-95);
      --leo-color-text-primary: var(--leo-color-primitive-neutral-10);
      --leo-color-text-secondary: var(--leo-color-primitive-neutral-40);
      --leo-color-text-tertiary: var(--leo-color-primitive-neutral-50);
      --leo-color-divider-subtle: var(--leo-color-primitive-neutral-90);
      --leo-color-icon-default: var(--leo-color-primitive-neutral-50);
    }

    [data-theme="light"] {
      --editor-background-color: var(--leo-color-container-background);
      /* White for editor */
      --preview-background-color: rgb(252, 248, 251);
      /* Light pinkish for preview */
      --surface-color: var(--leo-color-container-background);
      --text-primary: var(--leo-color-text-primary);
      --text-secondary: var(--leo-color-text-secondary);
      --border-color: var(--leo-color-divider-subtle);
      --border-subtle: var(--leo-color-divider-subtle);
      --surface-highlight: var(--leo-color-container-highlight);
    }

    [data-theme="dark"] {
      --leo-color-container-background: var(--leo-color-primitive-neutral-10);
      --leo-color-page-background: var(--leo-color-primitive-neutral-5);
      --leo-color-container-highlight: var(--leo-color-primitive-neutral-15);
      --leo-color-text-primary: var(--leo-color-primitive-neutral-90);
      --leo-color-text-secondary: var(--leo-color-primitive-neutral-60);
      --leo-color-text-tertiary: var(--leo-color-primitive-neutral-50);
      --leo-color-divider-subtle: var(--leo-color-primitive-neutral-20);
      --leo-color-icon-default: var(--leo-color-primitive-neutral-60);

      --editor-background-color: var(--leo-color-container-background);
      --preview-background-color: var(--leo-color-page-background);
      --surface-color: var(--leo-color-container-background);
      --text-primary: var(--leo-color-text-primary);
      --text-secondary: var(--leo-color-text-secondary);
      --border-color: var(--leo-color-divider-subtle);
      --border-subtle: var(--leo-color-divider-subtle);
      --surface-highlight: var(--leo-color-container-highlight);
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font: var(--leo-font-default-regular);
      color: var(--text-primary);
      transition: background-color 0.2s, color 0.2s;
      overflow: hidden;
    }

    .app {
      display: flex;
      height: 100vh;
      position: relative;
    }

    .editor-panel {
      background: var(--editor-background-color);
      border-right: 1px solid var(--border-color);
      overflow-y: auto;
      transition: background-color 0.2s;
    }

    .editor-content {
      padding: var(--leo-spacing-2xl);
      max-width: 900px;
      margin: 0 auto;
    }

    .preview-panel {
      background: var(--preview-background-color);
      overflow: hidden;
      position: relative;
      transition: background-color 0.2s;
    }

    .preview-content-wrapper {
      padding: var(--leo-spacing-2xl);
      height: 100%;
      overflow: hidden;
    }

    .resize-handle {
      width: 4px;
      background: var(--border-color);
      cursor: col-resize;
      position: relative;
      z-index: 10;
      transition: background-color 0.2s;
      flex-shrink: 0;
    }

    .resize-handle:hover {
      background: var(--leo-color-primitive-primary-40);
    }

    .resize-handle.dragging {
      background: var(--leo-color-primitive-primary-40);
    }

    .preview-content {
      height: 100%;
      overflow: hidden;
      container-type: inline-size;
    }

    .preview-viewport {
      transform-origin: top left;
      transition: transform 0.1s ease;
      height: 100%;
      overflow-y: auto;
      padding-bottom: var(--leo-spacing-2xl);
    }

    .instructions {
      background: linear-gradient(135deg, var(--surface-color) 0%, var(--surface-highlight) 100%);
      border-radius: var(--leo-radius-xl);
      padding: var(--leo-spacing-2xl);
      margin-bottom: var(--leo-spacing-2xl);
      border: 1px solid var(--border-color);
      border-left: 4px solid var(--leo-color-primitive-primary-40);
      box-shadow: var(--leo-effect-elevation-01);
    }

    .instructions h3 {
      font: var(--leo-font-heading-h4);
      color: var(--leo-color-primitive-primary-40);
      margin-bottom: var(--leo-spacing-xl);
      display: flex;
      align-items: center;
      gap: var(--leo-spacing-m);
    }

    .instructions h3::before {
      content: "‚ú®";
      font-size: 20px;
    }

    .instructions ol {
      margin-left: 20px;
      margin-bottom: var(--leo-spacing-xl);
    }

    .instructions li {
      margin-bottom: var(--leo-spacing-m);
      font: var(--leo-font-default-regular);
      line-height: 1.6;
    }

    .instructions .warning {
      background: linear-gradient(135deg, rgba(255, 193, 7, 0.1) 0%, rgba(255, 193, 7, 0.05) 100%);
      border: 1px solid rgba(255, 193, 7, 0.3);
      border-radius: var(--leo-radius-l);
      padding: var(--leo-spacing-xl);
      font: var(--leo-font-small-regular);
      color: #856404;
      margin-top: var(--leo-spacing-xl);
      display: flex;
      align-items: flex-start;
      gap: var(--leo-spacing-l);
    }

    .instructions .warning::before {
      content: "‚ö†Ô∏è";
      font-size: 18px;
      flex-shrink: 0;
    }

    [data-theme="dark"] .instructions .warning {
      background: linear-gradient(135deg, rgba(255, 215, 0, 0.1) 0%, rgba(255, 215, 0, 0.05) 100%);
      border-color: rgba(255, 215, 0, 0.3);
      color: #ffd700;
    }

    .theme-toggle {
      position: fixed;
      top: 20px;
      right: 20px;
      z-index: 1000;
      padding: var(--leo-spacing-l) var(--leo-spacing-xl);
      background: var(--surface-color);
      border: 1px solid var(--border-color);
      border-radius: var(--leo-radius-l);
      cursor: pointer;
      font: var(--leo-font-small-semibold);
      color: var(--text-primary);
      transition: all 0.2s;
      box-shadow: var(--leo-effect-elevation-01);
    }

    .theme-toggle:hover {
      background: var(--surface-highlight);
      transform: translateY(-1px);
      box-shadow: var(--leo-effect-elevation-03);
    }

    .panel-header {
      margin-bottom: var(--leo-spacing-2xl);
      text-align: center;
    }

    .panel-title {
      font: var(--leo-font-heading-h2);
      color: var(--text-primary);
      background: linear-gradient(135deg, var(--leo-color-primitive-primary-40) 0%, #6366f1 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .section-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: var(--leo-spacing-2xl);
      padding: var(--leo-spacing-xl);
      background: var(--surface-color);
      border-radius: var(--leo-radius-xl);
      border: 1px solid var(--border-color);
      box-shadow: var(--leo-effect-elevation-01);
    }

    .header-controls {
      display: flex;
      gap: var(--leo-spacing-l);
      align-items: center;
    }

    .add-card-btn,
    .import-btn {
      padding: var(--leo-spacing-l) var(--leo-spacing-2xl);
      border: none;
      border-radius: var(--leo-radius-l);
      font: var(--leo-font-default-semibold);
      cursor: pointer;
      transition: all 0.2s;
      position: relative;
      overflow: hidden;
    }

    .add-card-btn {
      background: linear-gradient(135deg, var(--leo-color-primitive-primary-40) 0%, #6366f1 100%);
      color: white;
      box-shadow: 0 4px 12px rgba(67, 79, 207, 0.3);
    }

    .add-card-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(67, 79, 207, 0.4);
    }

    .import-btn {
      background: linear-gradient(135deg, #34c759 0%, #10b981 100%);
      color: white;
      box-shadow: 0 4px 12px rgba(52, 199, 89, 0.3);
    }

    .import-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(52, 199, 89, 0.4);
    }

    .cards-grid {
      display: grid;
      gap: var(--leo-spacing-2xl);
      grid-template-columns: repeat(auto-fit, minmax(450px, 1fr));
    }

    /* Editor Card Styling - Cleaner and more elegant */
    .editor-card {
      background: var(--surface-color);
      border-radius: var(--leo-radius-xl);
      padding: var(--leo-spacing-2xl);
      border: 1px solid var(--border-color);
      transition: all 0.3s ease;
      position: relative;
      box-shadow: var(--leo-effect-elevation-01);
    }

    .editor-card:hover {
      border-color: var(--leo-color-primitive-primary-40);
      transform: translateY(-2px);
      box-shadow: var(--leo-effect-elevation-03);
    }

    .editor-card.empty-card {
      border: 2px dashed var(--border-color);
      background: linear-gradient(135deg, var(--surface-highlight) 0%, var(--surface-color) 100%);
    }

    .card-header {
      margin-bottom: var(--leo-spacing-2xl);
    }

    .card-title-wrapper {
      position: relative;
      margin-bottom: var(--leo-spacing-xl);
    }

    .card-title-input {
      font: var(--leo-font-heading-h4);
      color: var(--text-primary);
      border: 2px solid transparent;
      background: transparent;
      outline: none;
      width: 100%;
      padding: var(--leo-spacing-l) var(--leo-spacing-xl);
      border-radius: var(--leo-radius-l);
      transition: all 0.2s;
    }

    .card-title-input:hover {
      background: var(--surface-highlight);
      border-color: var(--border-color);
    }

    .card-title-input:focus {
      background: var(--surface-color);
      border-color: var(--leo-color-primitive-primary-40);
      box-shadow: 0 0 0 4px var(--leo-color-primitive-primary-95);
    }

    .edit-hint {
      position: absolute;
      top: -10px;
      right: 10px;
      background: var(--leo-color-primitive-primary-40);
      color: white;
      font: var(--leo-font-x-small-regular);
      font-weight: 600;
      padding: 4px var(--leo-spacing-m);
      border-radius: 6px;
      opacity: 0;
      transition: all 0.2s;
      pointer-events: none;
      transform: translateY(5px);
    }

    .card-title-wrapper:hover .edit-hint {
      opacity: 1;
      transform: translateY(0);
    }

    .card-meta {
      padding: var(--leo-spacing-xl);
      background: linear-gradient(135deg, var(--surface-highlight) 0%, rgba(67, 79, 207, 0.02) 100%);
      border-radius: var(--leo-radius-l);
      border: 1px solid var(--border-color);
    }

    .form-group {
      margin-bottom: var(--leo-spacing-xl);
    }

    .form-group:last-child {
      margin-bottom: 0;
    }

    .form-label {
      display: block;
      margin-bottom: var(--leo-spacing-m);
      font: var(--leo-font-small-semibold);
      color: var(--text-primary);
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .form-description {
      font: var(--leo-font-x-small-regular);
      color: var(--text-secondary);
      margin-bottom: var(--leo-spacing-l);
      font-style: italic;
      line-height: 1.5;
    }

    .form-input {
      width: 100%;
      padding: var(--leo-spacing-l) var(--leo-spacing-xl);
      border: 1px solid var(--border-color);
      border-radius: var(--leo-radius-l);
      font: var(--leo-font-small-regular);
      transition: all 0.2s;
      background: var(--surface-color);
      color: var(--text-primary);
    }

    .form-input:focus {
      outline: none;
      border-color: var(--leo-color-primitive-primary-40);
      box-shadow: 0 0 0 3px var(--leo-color-primitive-primary-95);
    }

    .empty-card-content {
      text-align: center;
      padding: 40px 20px;
      color: var(--text-secondary);
    }

    .empty-card-icon {
      font-size: 56px;
      margin-bottom: var(--leo-spacing-xl);
      opacity: 0.6;
    }

    .empty-card-text {
      font: var(--leo-font-large-semibold);
      margin-bottom: var(--leo-spacing-l);
      color: var(--text-primary);
    }

    .empty-card-hint {
      font: var(--leo-font-default-regular);
      color: var(--text-secondary);
    }

    .items-list {
      display: flex;
      flex-direction: column;
      gap: var(--leo-spacing-l);
      background: linear-gradient(135deg, var(--surface-highlight) 0%, rgba(67, 79, 207, 0.02) 100%);
      border-radius: var(--leo-radius-xl);
      /* padding: var(--leo-spacing-xl); */
      /* border: 1px solid var(--border-color); */
    }

    .items-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: var(--leo-spacing-xl);
      padding-bottom: var(--leo-spacing-l);
      border-bottom: 2px solid var(--border-subtle);
    }

    .items-count {
      font: var(--leo-font-default-semibold);
      color: var(--text-secondary);
      background: var(--surface-color);
      padding: var(--leo-spacing-m) var(--leo-spacing-l);
      border-radius: var(--leo-radius-l);
    }

    .add-item-btn {
      padding: var(--leo-spacing-l) var(--leo-spacing-xl);
      background: linear-gradient(135deg, #34c759 0%, #10b981 100%);
      color: white;
      border: none;
      border-radius: var(--leo-radius-l);
      font: var(--leo-font-small-semibold);
      cursor: pointer;
      transition: all 0.2s;
      box-shadow: 0 2px 8px rgba(52, 199, 89, 0.3);
    }

    .add-item-btn:hover {
      transform: translateY(-1px);
      box-shadow: 0 4px 12px rgba(52, 199, 89, 0.4);
    }

    /* Editor Item Styling - More elegant */
    .editor-item {
      display: flex;
      align-items: flex-start;
      gap: var(--leo-spacing-xl);
      padding: var(--leo-spacing-xl);
      border-radius: var(--leo-radius-xl);
      border: 1px solid var(--border-subtle);
      background: var(--surface-color);
      transition: all 0.2s;
      cursor: move;
      position: relative;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04);
    }

    .editor-item:hover {
      background: var(--surface-color);
      border-color: var(--leo-color-primitive-primary-40);
      transform: translateY(-1px);
      box-shadow: 0 4px 16px rgba(0, 0, 0, 0.08);
    }

    .item-drag-handle {
      position: absolute;
      left: var(--leo-spacing-l);
      top: var(--leo-spacing-xl);
      color: var(--text-secondary);
      font-size: 18px;
      cursor: grab;
      line-height: 1;
      user-select: none;
      opacity: 0.6;
      transition: opacity 0.2s;
    }

    .editor-item:hover .item-drag-handle {
      opacity: 1;
    }

    .item-drag-handle:active {
      cursor: grabbing;
    }

    .item-thumbnail-section {
      margin-left: var(--leo-spacing-xl);
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: var(--leo-spacing-l);
    }

    .item-thumbnail-editor {
      width: 56px;
      height: 56px;
      border-radius: var(--leo-radius-l);
      overflow: hidden;
      flex-shrink: 0;
      background: var(--border-color);
      display: flex;
      align-items: center;
      justify-content: center;
      border: 2px dashed transparent;
      transition: all 0.2s;
      cursor: pointer;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    }

    .item-thumbnail-editor:hover {
      border-color: var(--leo-color-primitive-primary-40);
      transform: scale(1.05);
    }

    .item-thumbnail-editor img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .thumbnail-placeholder {
      color: var(--text-secondary);
      font-size: 24px;
    }

    .thumbnail-upload-btn {
      font: var(--leo-font-x-small-regular);
      font-weight: 600;
      padding: 6px var(--leo-spacing-l);
      background: linear-gradient(135deg, var(--leo-color-primitive-primary-40) 0%, #6366f1 100%);
      color: white;
      border: none;
      border-radius: var(--leo-radius-l);
      cursor: pointer;
      white-space: nowrap;
      transition: all 0.2s;
      box-shadow: 0 2px 6px rgba(67, 79, 207, 0.3);
    }

    .thumbnail-upload-btn:hover {
      transform: translateY(-1px);
      box-shadow: 0 4px 10px rgba(67, 79, 207, 0.4);
    }

    .item-content-editor {
      flex: 1;
      display: flex;
      flex-direction: column;
      gap: var(--leo-spacing-l);
    }

    .item-title-editor,
    .item-description-editor {
      border: 1px solid transparent;
      background: transparent;
      outline: none;
      padding: var(--leo-spacing-l) var(--leo-spacing-xl);
      border-radius: var(--leo-radius-l);
      transition: all 0.2s;
    }

    .item-title-editor {
      font: var(--leo-font-large-semibold);
      color: var(--text-primary);
    }

    .item-description-editor {
      font: var(--leo-font-default-regular);
      color: var(--text-secondary);
      resize: none;
      min-height: 50px;
    }

    .item-title-editor:hover,
    .item-title-editor:focus,
    .item-description-editor:hover,
    .item-description-editor:focus {
      background: var(--surface-highlight);
      border-color: var(--leo-color-primitive-primary-40);
      box-shadow: 0 0 0 2px var(--leo-color-primitive-primary-95);
    }

    .item-url-section {
      /* margin-top: var(--leo-spacing-l); */
      padding: var(--leo-spacing-xl);
      background: linear-gradient(135deg, var(--surface-highlight) 0%, rgba(67, 79, 207, 0.02) 100%);
      border-radius: var(--leo-radius-l);
      /* border: 1px solid var(--border-color); */
    }

    .url-label {
      display: flex;
      align-items: center;
      gap: var(--leo-spacing-m);
      font: var(--leo-font-x-small-regular);
      font-weight: 600;
      color: var(--leo-color-primitive-primary-40);
      margin-bottom: var(--leo-spacing-m);
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .url-input {
      width: 100%;
      padding: var(--leo-spacing-l) var(--leo-spacing-xl);
      border: 1px solid var(--border-color);
      border-radius: var(--leo-radius-l);
      font: var(--leo-font-small-regular);
      background: var(--surface-color);
      color: var(--text-primary);
      transition: all 0.2s;
    }

    .url-input:focus {
      outline: none;
      border-color: var(--leo-color-primitive-primary-40);
      box-shadow: 0 0 0 2px var(--leo-color-primitive-primary-95);
    }

    .item-controls {
      display: flex;
      flex-direction: column;
      gap: var(--leo-spacing-l);
      opacity: 0;
      transition: opacity 0.2s;
    }

    .editor-item:hover .item-controls {
      opacity: 1;
    }

    .delete-item-btn,
    .delete-card-btn {
      background: linear-gradient(135deg, #ff3b30 0%, #dc2626 100%);
      color: white;
      border: none;
      padding: var(--leo-spacing-l) var(--leo-spacing-xl);
      border-radius: var(--leo-radius-l);
      cursor: pointer;
      font: var(--leo-font-small-semibold);
      white-space: nowrap;
      transition: all 0.2s;
      box-shadow: 0 2px 8px rgba(255, 59, 48, 0.3);
    }

    .delete-item-btn:hover,
    .delete-card-btn:hover {
      transform: translateY(-1px);
      box-shadow: 0 4px 12px rgba(255, 59, 48, 0.4);
    }

    .card-controls {
      margin-top: var(--leo-spacing-2xl);
      display: flex;
      justify-content: space-between;
      align-items: flex-end;
      gap: var(--leo-spacing-xl);
      padding-top: var(--leo-spacing-xl);
      /* border-top: 1px solid var(--border-color); */
    }

    .card-controls-left {
      flex: 1;
    }

    .card-controls-right {
      display: flex;
      gap: var(--leo-spacing-l);
    }

    /* Preview Panel Styling */
    .preview-controls {
      margin-bottom: var(--leo-spacing-2xl);
      display: flex;
      gap: var(--leo-spacing-xl);
      align-items: center;
      flex-wrap: wrap;
      padding: var(--leo-spacing-xl);
      background: var(--surface-color);
      border-radius: var(--leo-radius-xl);
      border: 1px solid var(--border-color);
      box-shadow: var(--leo-effect-elevation-01);
    }

    .zoom-controls {
      display: flex;
      align-items: center;
      gap: var(--leo-spacing-l);
      background: var(--surface-highlight);
      border-radius: var(--leo-radius-l);
      border: 1px solid var(--border-color);
      padding: var(--leo-spacing-m);
    }

    .zoom-btn {
      padding: var(--leo-spacing-l);
      border: none;
      background: transparent;
      cursor: pointer;
      color: var(--text-primary);
      border-radius: var(--leo-spacing-m);
      transition: all 0.2s;
      width: 36px;
      height: 36px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 600;
    }

    .zoom-btn:hover {
      background: var(--surface-color);
      transform: scale(1.1);
    }

    .zoom-level {
      font: var(--leo-font-small-semibold);
      color: var(--text-primary);
      min-width: 60px;
      text-align: center;
      background: var(--surface-color);
      padding: var(--leo-spacing-m) var(--leo-spacing-l);
      border-radius: var(--leo-spacing-m);
    }

    .preview-container {
      min-height: 400px;
    }

    /* Container-based responsive grid layout */
    .preview-cards-grid {
      display: grid;
      gap: var(--leo-spacing-2xl);
      grid-template-columns: repeat(2, 1fr);
      max-width: 900px;
      margin: 0 auto;
    }

    /* Use container queries for true responsive behavior */
    @container (max-width: 500px) {
      .preview-cards-grid {
        grid-template-columns: 1fr;
      }
    }

    /* Content card styling for preview - matching Brave design from stylesheets */
    .content-card {
      border-radius: var(--leo-radius-xl);
      padding: 4px;
      background-color: rgb(from var(--leo-color-container-background) r g b / 55%);
      display: flex;
      flex-direction: column;
      gap: 4px;
      width: 100%;
      break-inside: avoid;
      margin-bottom: 0;
    }

    .content-card h4 {
      font: var(--leo-font-heading-h4);
      color: var(--text-primary);
      margin-bottom: 0;
      padding: var(--leo-spacing-xl);
      padding-bottom: var(--leo-spacing-l);
      line-height: 1.3;
    }

    .content-card section {
      border-radius: var(--leo-radius-l);
      background: var(--leo-color-container-background);
      width: 100%;
      display: flex;
      flex-direction: column;
      gap: 0;
    }

    .content-card a {
      display: flex;
      gap: var(--leo-spacing-xl);
      text-decoration: none;
      color: var(--text-primary);
      padding: var(--leo-spacing-m);
      border-bottom: solid 1px var(--leo-color-divider-subtle);
      transition: all 0.2s;
      align-items: center;
    }

    .content-card a:last-child {
      border-bottom: none;
    }

    .content-card a:hover {
      background-color: var(--surface-highlight);
    }

    .thumbnail {
      flex: 0 0 56px;
      height: 56px;
      width: 56px;
      overflow: hidden;
      border-radius: var(--leo-radius-l);
      border: solid 1px var(--leo-color-divider-subtle);
      display: flex;
      align-items: center;
      justify-content: center;
      background: var(--surface-highlight);
    }

    .thumbnail img {
      width: 100%;
      height: auto;
      object-fit: cover;
    }

    .thumbnail-placeholder-preview {
      color: var(--text-secondary);
      font-size: 24px;
    }

    .item-info {
      display: flex;
      flex-direction: column;
      gap: 4px;
      flex: 1;
    }

    .item-info .title {
      font: var(--leo-font-default-semibold);
      color: var(--text-primary);
      line-height: 1.3;
    }

    .item-info .description {
      font: var(--leo-font-x-small-regular);
      color: var(--leo-color-text-tertiary);
      line-height: 1.4;
    }

    .json-section {
      margin-top: 40px;
      padding-top: var(--leo-spacing-2xl);
      border-top: 2px solid var(--border-color);
    }

    .json-output {
      width: 100%;
      min-height: 400px;
      padding: var(--leo-spacing-2xl);
      background: #1a1a1a;
      color: #ffffff;
      border: none;
      border-radius: var(--leo-radius-xl);
      font-family: 'SF Mono', Monaco, 'Cascadia Code', monospace;
      font-size: 12px;
      line-height: 1.6;
      resize: vertical;
      box-shadow: var(--leo-effect-elevation-03);
    }

    .copy-btn {
      margin-top: var(--leo-spacing-xl);
      padding: var(--leo-spacing-l) var(--leo-spacing-2xl);
      background: linear-gradient(135deg, #34c759 0%, #10b981 100%);
      color: white;
      border: none;
      border-radius: var(--leo-radius-l);
      cursor: pointer;
      font: var(--leo-font-default-semibold);
      transition: all 0.2s;
      box-shadow: 0 4px 12px rgba(52, 199, 89, 0.3);
    }

    .copy-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(52, 199, 89, 0.4);
    }

    .empty-state {
      text-align: center;
      padding: 80px 20px;
      color: var(--text-secondary);
    }

    .empty-state-icon {
      font-size: 64px;
      margin-bottom: var(--leo-spacing-2xl);
      opacity: 0.6;
    }

    /* Confirmation modal styles */
    .modal-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.5);
      backdrop-filter: blur(4px);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 1000;
    }

    .modal {
      background: var(--surface-color);
      border-radius: var(--leo-radius-xl);
      padding: var(--leo-spacing-2xl);
      border: 1px solid var(--border-color);
      max-width: 400px;
      width: 90vw;
      box-shadow: var(--leo-effect-elevation-03);
    }

    .modal h3 {
      font: var(--leo-font-heading-h4);
      color: var(--text-primary);
      margin-bottom: var(--leo-spacing-xl);
    }

    .modal p {
      font: var(--leo-font-default-regular);
      color: var(--text-secondary);
      margin-bottom: var(--leo-spacing-2xl);
      line-height: 1.6;
    }

    .modal-actions {
      display: flex;
      gap: var(--leo-spacing-l);
      justify-content: flex-end;
    }

    .modal-btn {
      padding: var(--leo-spacing-l) var(--leo-spacing-2xl);
      border: none;
      border-radius: var(--leo-radius-l);
      cursor: pointer;
      font: var(--leo-font-default-semibold);
      transition: all 0.2s;
    }

    .modal-btn.cancel {
      background: var(--surface-highlight);
      color: var(--text-primary);
    }

    .modal-btn.confirm {
      background: linear-gradient(135deg, #ff3b30 0%, #dc2626 100%);
      color: white;
      box-shadow: 0 4px 12px rgba(255, 59, 48, 0.3);
    }

    .modal-btn:hover {
      transform: translateY(-1px);
    }

    /* Import Modal Styles */
    .import-modal {
      max-width: 600px;
      width: 90vw;
    }

    .import-textarea {
      width: 100%;
      min-height: 300px;
      padding: var(--leo-spacing-2xl);
      background: #1a1a1a;
      color: #ffffff;
      border: 1px solid var(--border-color);
      border-radius: var(--leo-radius-xl);
      font-family: 'SF Mono', Monaco, 'Cascadia Code', monospace;
      font-size: 12px;
      line-height: 1.6;
      resize: vertical;
      margin-bottom: var(--leo-spacing-xl);
    }

    .import-textarea::placeholder {
      color: #888;
    }

    /* Responsive breakpoints for overall layout */
    @media (max-width: 1024px) {
      .app {
        flex-direction: column;
      }

      .resize-handle {
        width: 100%;
        height: 4px;
        cursor: row-resize;
      }

      .cards-grid {
        grid-template-columns: 1fr;
      }

      .preview-cards-grid {
        grid-template-columns: 1fr;
      }

      .item-controls {
        opacity: 1;
      }

      .card-controls {
        flex-direction: column;
        align-items: stretch;
      }

      .preview-controls {
        flex-direction: column;
        align-items: flex-start;
      }

      .preview-cards-grid {
        max-width: 100%;
      }

      .header-controls {
        flex-direction: column;
        width: 100%;
      }

      .editor-content,
      .preview-content-wrapper {
        padding: var(--leo-spacing-xl);
      }
    }
  </style>
</head>

<body data-theme="light">
  <div id="app">
    <button @click="toggleTheme" class="theme-toggle">
      {{ isDarkMode ? '‚òÄÔ∏è Light Mode' : 'üåô Dark Mode' }}
    </button>

    <div class="app">
      <!-- Editor Panel -->
      <div class="editor-panel" :style="{ width: editorWidth + 'px' }">
        <div class="editor-content">
          <div class="panel-header">
            <h1 class="panel-title">Rewards Offer Wall Card Editor</h1>
          </div>

          <!-- Instructions Section -->
          <div class="instructions">
            <h3>How to Use This Card Editor</h3>
            <ol>
              <li><strong>Add and Edit Cards:</strong> Click "Add New Card" to create cards, then click on any text to
                edit titles, descriptions, and URLs.</li>
              <li><strong>Import JSON:</strong> Click "Import JSON" to load an existing card configuration from a
                previous session.</li>
              <li><strong>Share Your Work:</strong> The JSON output below updates automatically and can be shared with
                others to reproduce your card layout.</li>
              <li><strong>Add Images:</strong> Click thumbnail areas or "Change" buttons to add image URLs to your
                cards.</li>
            </ol>
            <div class="warning">
              <strong>Important:</strong> Your work is not automatically saved. Do not refresh the page or navigate
              away, or you will lose all your changes!
            </div>
          </div>

          <div class="header-controls">
            <button @click="showImportModal" class="import-btn">üì• Import JSON</button>
            <button @click="addCard" class="add-card-btn">+ Add New Card</button>
          </div>

          <br />

          <div class="cards-grid" ref="cardsGrid">
            <div v-for="(card, cardIndex) in cards" :key="card.id"
              :class="['editor-card', { 'empty-card': card.items.length === 0 }]">
              <!-- Card Title -->
              <div class="card-header">
                <div class="card-title-wrapper">
                  <input v-model="card.title" class="card-title-input" placeholder="Click to edit card title..." />
                  <span class="edit-hint">Click to edit</span>
                </div>

                <!-- Card Metadata -->
                <div class="card-meta">
                  <div class="form-group">
                    <label class="form-label">Card ID</label>
                    <div class="form-description">This is the unique card identifier for code purposes. Users will not
                      see this.</div>
                    <input v-model="card.key" class="form-input" placeholder="unique-card-id" />
                  </div>
                </div>
              </div>

              <!-- Empty Card State -->
              <div v-if="card.items.length === 0" class="empty-card-content">
                <div class="empty-card-icon">üìù</div>
                <div class="empty-card-text">{{ card.title || 'New Card' }}</div>
                <div class="empty-card-hint">Add items to populate this card</div>
              </div>

              <!-- Card with Items -->
              <div v-else class="card-section">
                <div class="items-header">
                  <span class="items-count">{{ card.items.length }} item{{ card.items.length !== 1 ? 's' : '' }}</span>
                </div>

                <div :ref="el => sortableRefs[cardIndex] = el" class="items-list">
                  <div v-for="(item, itemIndex) in card.items" :key="item.id" class="editor-item" :data-id="item.id">
                    <span class="item-drag-handle">‚ãÆ‚ãÆ</span>

                    <div class="item-thumbnail-section">
                      <div class="item-thumbnail-editor" @click="focusThumbnailInput(cardIndex, itemIndex)">
                        <img v-if="item.thumbnail" :src="item.thumbnail" :alt="item.title"
                          @error="$event.target.style.display = 'none'" />
                        <span v-else class="thumbnail-placeholder"></span>
                      </div>
                      <button class="thumbnail-upload-btn" @click="focusThumbnailInput(cardIndex, itemIndex)">
                        {{ item.thumbnail ? 'Change' : 'Add Image' }}
                      </button>
                    </div>

                    <div class="item-content-editor">
                      <input v-model="item.title" class="item-title-editor" placeholder="Click to edit item title..." />
                      <textarea v-model="item.description" class="item-description-editor"
                        placeholder="Click to edit description..." rows="2"></textarea>

                      <div class="item-url-section">
                        <div class="url-label">
                          üîó Link URL
                        </div>
                        <input v-model="item.url" class="url-input" placeholder="https://example.com" type="url" />
                      </div>

                      <!-- Hidden thumbnail URL input -->
                      <input v-model="item.thumbnail" :ref="el => thumbnailInputRefs[`${cardIndex}-${itemIndex}`] = el"
                        style="position: absolute; left: -9999px; opacity: 0;" placeholder="Image URL" type="url"
                        @blur="onThumbnailInputBlur" />
                    </div>

                    <div class="item-controls">
                      <button @click="confirmDeleteItem(cardIndex, itemIndex)" class="delete-item-btn">
                        Delete Item
                      </button>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Card Controls -->
              <div class="card-controls">
                <div class="card-controls-left"></div>
                <div class="card-controls-right">
                  <button @click="addItem(cardIndex)" class="add-item-btn">+ Add Item</button>
                  <button @click="confirmDeleteCard(cardIndex)" class="delete-card-btn">Delete Card</button>
                </div>
              </div>
            </div>
          </div>

          <!-- JSON Output Section -->
          <div class="json-section">
            <h2 class="section-title" style="font: var(--leo-font-heading-h4); margin-bottom: 12px;">JSON Output</h2>
            <textarea :value="jsonOutput" readonly class="json-output"
              placeholder="JSON will appear here..."></textarea>
            <button @click="copyToClipboard" class="copy-btn">Copy JSON</button>
          </div>
        </div>
      </div>

      <!-- Resize Handle -->
      <div class="resize-handle" :class="{ dragging: isResizing }" @mousedown="startResize"></div>

      <!-- Preview Panel -->
      <div class="preview-panel" :style="{ width: previewWidth + 'px' }">
        <div class="preview-content-wrapper">
          <div class="panel-header">
            <h1 class="panel-title">Live Preview</h1>
          </div>

          <div class="preview-controls">
            <div class="zoom-controls">
              <button @click="zoomOut" class="zoom-btn">‚àí</button>
              <span class="zoom-level">{{ Math.round(zoomLevel * 100) }}%</span>
              <button @click="zoomIn" class="zoom-btn">+</button>
            </div>
          </div>

          <div class="preview-content">
            <div class="preview-viewport" :style="{ transform: `scale(${zoomLevel})` }">
              <div class="preview-container">
                <div v-if="visibleCards.length === 0" class="empty-state">
                  <div class="empty-state-icon">üëÅÔ∏è</div>
                  <p>No cards to preview. Add cards with items to see them here.</p>
                </div>

                <!-- Container-responsive grid layout -->
                <div v-else class="preview-cards-grid">
                  <div v-for="card in visibleCards" :key="card.id" class="content-card">
                    <h4>{{ card.title || 'Untitled Card' }}</h4>
                    <section>
                      <a v-for="(item, index) in card.items" :key="index" :href="item.url || '#'" target="_blank"
                        rel="noopener noreferrer">
                        <span class="thumbnail">
                          <img v-if="item.thumbnail" :src="item.thumbnail" :alt="item.title"
                            @error="$event.target.style.display = 'none'" />
                          <span v-else class="thumbnail-placeholder-preview">üîó</span>
                        </span>
                        <span class="item-info">
                          <span class="title">{{ item.title || 'Untitled' }}</span>
                          <span class="description">{{ item.description || 'No description' }}</span>
                        </span>
                      </a>
                    </section>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Confirmation Modal -->
    <div v-if="showConfirmModal" class="modal-overlay" @click="cancelDelete">
      <div class="modal" @click.stop>
        <h3>{{ confirmModalTitle }}</h3>
        <p>{{ confirmModalMessage }}</p>
        <div class="modal-actions">
          <button @click="cancelDelete" class="modal-btn cancel">Cancel</button>
          <button @click="confirmDelete" class="modal-btn confirm">Delete</button>
        </div>
      </div>
    </div>

    <!-- Import Modal -->
    <div v-if="showImportDialog" class="modal-overlay" @click="hideImportModal">
      <div class="modal import-modal" @click.stop>
        <h3>Import JSON Configuration</h3>
        <p>Paste your JSON configuration below to load an existing workspace:</p>
        <textarea v-model="importJsonText" class="import-textarea" placeholder="Paste your JSON here..."
          @keyup.escape="hideImportModal"></textarea>
        <div class="modal-actions">
          <button @click="hideImportModal" class="modal-btn cancel">Cancel</button>
          <button @click="importJson" class="modal-btn confirm" style="background: #34c759;">Import</button>
        </div>
      </div>
    </div>
  </div>

  <script>
    const { createApp, ref, computed, nextTick, onMounted, watch, onUnmounted } = Vue;

    createApp({
      setup() {
        const cards = ref([]);
        const sortableRefs = ref([]);
        const sortableInstances = ref([]);
        const thumbnailInputRefs = ref({});
        const isDarkMode = ref(false);
        const zoomLevel = ref(1.0);
        const cardsGrid = ref(null);
        const showConfirmModal = ref(false);
        const confirmModalTitle = ref('');
        const confirmModalMessage = ref('');
        const pendingDeleteAction = ref(null);
        const showImportDialog = ref(false);
        const importJsonText = ref('');

        // Resize functionality
        const isResizing = ref(false);
        const editorWidth = ref(window.innerWidth * 0.5);
        const previewWidth = ref(window.innerWidth * 0.5 - 4); // subtract resize handle width

        let cardIdCounter = 1;
        let itemIdCounter = 1;

        const startResize = (e) => {
          isResizing.value = true;
          document.addEventListener('mousemove', handleResize);
          document.addEventListener('mouseup', stopResize);
          e.preventDefault();
        };

        const handleResize = (e) => {
          if (isResizing.value) {
            const newEditorWidth = Math.max(300, Math.min(window.innerWidth - 350, e.clientX));
            editorWidth.value = newEditorWidth;
            previewWidth.value = window.innerWidth - newEditorWidth - 4; // subtract resize handle width
          }
        };

        const stopResize = () => {
          isResizing.value = false;
          document.removeEventListener('mousemove', handleResize);
          document.removeEventListener('mouseup', stopResize);
        };

        const handleWindowResize = () => {
          if (window.innerWidth <= 1024) {
            // On mobile, reset to full width
            editorWidth.value = window.innerWidth;
            previewWidth.value = window.innerWidth;
          } else {
            // Maintain proportions on desktop
            const totalWidth = window.innerWidth;
            const ratio = editorWidth.value / (editorWidth.value + previewWidth.value);
            editorWidth.value = totalWidth * ratio;
            previewWidth.value = totalWidth * (1 - ratio) - 4;
          }
        };

        const toggleTheme = () => {
          isDarkMode.value = !isDarkMode.value;
          document.body.setAttribute('data-theme', isDarkMode.value ? 'dark' : 'light');
        };

        const zoomIn = () => {
          zoomLevel.value = Math.min(zoomLevel.value + 0.1, 2);
        };

        const zoomOut = () => {
          zoomLevel.value = Math.max(zoomLevel.value - 0.1, 0.3);
        };

        const showImportModal = () => {
          importJsonText.value = '';
          showImportDialog.value = true;
        };

        const hideImportModal = () => {
          showImportDialog.value = false;
          importJsonText.value = '';
        };

        const importJson = () => {
          try {
            const jsonData = JSON.parse(importJsonText.value);

            // Clear existing cards
            cards.value = [];

            // Convert JSON back to card format
            Object.keys(jsonData).forEach(key => {
              const cardData = jsonData[key];
              const newCard = {
                id: cardIdCounter++,
                key: key,
                title: cardData.title || 'Untitled Card',
                items: cardData.items.map(item => ({
                  id: itemIdCounter++,
                  title: item.title || '',
                  description: item.description || '',
                  url: item.url || '',
                  thumbnail: item.thumbnail || ''
                }))
              };
              cards.value.push(newCard);
            });

            hideImportModal();

            // Initialize sortable for imported cards
            nextTick(() => {
              initializeSortable();
            });

            alert('JSON imported successfully!');
          } catch (error) {
            alert('Invalid JSON format. Please check your input and try again.');
            console.error('JSON import error:', error);
          }
        };

        // Initialize with clean sample data
        const initializeData = () => {
          cards.value = [
            {
              id: cardIdCounter++,
              key: 'partner-promo-card',
              title: 'Rewards Partner Offers',
              items: [
                {
                  id: itemIdCounter++,
                  title: "Brave + Unstoppable Domains ü§ù",
                  description: "Buy your .brave domain with BAT and send it easily through your domain.",
                  url: "https://get.unstoppabledomains.com/brave/",
                  thumbnail: "https://rewards.brave.com/cards/udthumbnail.jpg"
                },
                {
                  id: itemIdCounter++,
                  title: "Decentraland: Beta now live",
                  description: "Download and explore to receive an exclusive Brave Wearable",
                  url: "https://decentraland.org/?utm_org=dcl&utm_source=brave&utm_medium=paid&utm_campaign=brandlaunch&utm_term=offerwall&utm_content=brave_wearable",
                  thumbnail: "https://rewards.brave.com/cards/decentraland.png"
                },
                {
                  id: itemIdCounter++,
                  title: "Pudgy Penguins: Crush It!",
                  description: "450 Pop Points Bonus - Only for Brave users!",
                  url: "https://www.pudgypop.com/signup?r=BAT",
                  thumbnail: "https://rewards.brave.com/cards/thumb-pudgy-penguins-crush-it.png"
                },
                {
                  id: itemIdCounter++,
                  title: "Karate Combat: Game On!",
                  description: "$KARATE Fans, Your Loyalty Pays Off! Grab VIP Benefits Now.",
                  url: "https://www.karate.com/app",
                  thumbnail: "https://rewards.brave.com/cards/thumb-karate-fans-your-loyalty.png"
                },
                {
                  id: itemIdCounter++,
                  title: "Believe in something, CHOMP it",
                  description: "Get rewarded by sharing your opinions and beliefs.",
                  url: "https://chomp.games/?utm_source=brave&utm_medium=offerwall",
                  thumbnail: "https://rewards.brave.com/cards/thumb-believe-in-somthing-chomp-it.png"
                }
              ]
            }
          ];
        };

        const scrollToNewCard = () => {
          nextTick(() => {
            if (cardsGrid.value) {
              const cardElements = cardsGrid.value.children;
              if (cardElements.length > 0) {
                const lastCard = cardElements[cardElements.length - 1];
                lastCard.scrollIntoView({
                  behavior: 'smooth',
                  block: 'center'
                });
              }
            }
          });
        };

        const addCard = () => {
          const newCard = {
            id: cardIdCounter++,
            key: `card-${cardIdCounter}`,
            title: 'New Card',
            items: []
          };
          cards.value.push(newCard);
          scrollToNewCard();
        };

        const confirmDeleteCard = (cardIndex) => {
          const card = cards.value[cardIndex];
          confirmModalTitle.value = 'Delete Card';
          confirmModalMessage.value = `Are you sure you want to delete "${card.title || 'Untitled Card'}"? This action cannot be undone.`;
          pendingDeleteAction.value = () => deleteCard(cardIndex);
          showConfirmModal.value = true;
        };

        const deleteCard = (cardIndex) => {
          cards.value.splice(cardIndex, 1);
        };

        const addItem = (cardIndex) => {
          cards.value[cardIndex].items.push({
            id: itemIdCounter++,
            title: '',
            description: '',
            url: '',
            thumbnail: ''
          });

          // Initialize sortable for this card if it's the first item
          if (cards.value[cardIndex].items.length === 1) {
            nextTick(() => {
              initializeSortableForCard(cardIndex);
            });
          }

          // Scroll to the new item
          nextTick(() => {
            const cardElement = sortableRefs.value[cardIndex];
            if (cardElement) {
              const itemElements = cardElement.children;
              if (itemElements.length > 0) {
                const lastItem = itemElements[itemElements.length - 1];
                lastItem.scrollIntoView({
                  behavior: 'smooth',
                  block: 'nearest'
                });
              }
            }
          });
        };

        const confirmDeleteItem = (cardIndex, itemIndex) => {
          const item = cards.value[cardIndex].items[itemIndex];
          confirmModalTitle.value = 'Delete Item';
          confirmModalMessage.value = `Are you sure you want to delete "${item.title || 'Untitled Item'}"? This action cannot be undone.`;
          pendingDeleteAction.value = () => deleteItem(cardIndex, itemIndex);
          showConfirmModal.value = true;
        };

        const deleteItem = (cardIndex, itemIndex) => {
          cards.value[cardIndex].items.splice(itemIndex, 1);
        };

        const confirmDelete = () => {
          if (pendingDeleteAction.value) {
            pendingDeleteAction.value();
          }
          cancelDelete();
        };

        const cancelDelete = () => {
          showConfirmModal.value = false;
          confirmModalTitle.value = '';
          confirmModalMessage.value = '';
          pendingDeleteAction.value = null;
        };

        const focusThumbnailInput = (cardIndex, itemIndex) => {
          const key = `${cardIndex}-${itemIndex}`;
          const input = thumbnailInputRefs.value[key];
          if (input) {
            const currentValue = input.value;
            const newValue = prompt('Enter image URL:', currentValue);
            if (newValue !== null) {
              cards.value[cardIndex].items[itemIndex].thumbnail = newValue;
            }
          }
        };

        const onThumbnailInputBlur = () => {
          // This function can be used if needed for future enhancements
        };

        const visibleCards = computed(() => {
          return cards.value.filter(card => card.items.length > 0 && card.key);
        });

        const jsonOutput = computed(() => {
          if (visibleCards.value.length === 0) {
            return '';
          }

          const output = {};
          visibleCards.value.forEach(card => {
            const cleanItems = card.items.map(item => ({
              title: item.title,
              description: item.description,
              url: item.url,
              thumbnail: item.thumbnail
            }));

            output[card.key] = {
              title: card.title,
              items: cleanItems
            };
          });

          return JSON.stringify(output, null, 2);
        });

        const copyToClipboard = async () => {
          try {
            await navigator.clipboard.writeText(jsonOutput.value);
            alert('JSON copied to clipboard!');
          } catch (err) {
            console.error('Failed to copy: ', err);
          }
        };

        const initializeSortableForCard = (cardIndex) => {
          const container = sortableRefs.value[cardIndex];
          if (container && !sortableInstances.value[cardIndex]) {
            sortableInstances.value[cardIndex] = Sortable.create(container, {
              handle: '.item-drag-handle',
              animation: 150,
              ghostClass: 'sortable-ghost',
              onEnd: (evt) => {
                const oldIndex = evt.oldIndex;
                const newIndex = evt.newIndex;

                if (oldIndex !== newIndex) {
                  const movedItem = cards.value[cardIndex].items.splice(oldIndex, 1)[0];
                  cards.value[cardIndex].items.splice(newIndex, 0, movedItem);
                }
              }
            });
          }
        };

        const initializeSortable = () => {
          nextTick(() => {
            cards.value.forEach((card, cardIndex) => {
              if (card.items.length > 0) {
                initializeSortableForCard(cardIndex);
              }
            });
          });
        };

        onMounted(() => {
          initializeData();
          initializeSortable();
          window.addEventListener('resize', handleWindowResize);
        });

        onUnmounted(() => {
          window.removeEventListener('resize', handleWindowResize);
          document.removeEventListener('mousemove', handleResize);
          document.removeEventListener('mouseup', stopResize);
        });

        // Watch for changes that require sortable re-initialization
        watch(cards, () => {
          nextTick(() => {
            initializeSortable();
          });
        }, { deep: true });

        return {
          cards,
          sortableRefs,
          thumbnailInputRefs,
          visibleCards,
          isDarkMode,
          zoomLevel,
          cardsGrid,
          showConfirmModal,
          confirmModalTitle,
          confirmModalMessage,
          showImportDialog,
          importJsonText,
          // Resize functionality
          isResizing,
          editorWidth,
          previewWidth,
          startResize,
          addCard,
          confirmDeleteCard,
          deleteCard,
          addItem,
          confirmDeleteItem,
          deleteItem,
          confirmDelete,
          cancelDelete,
          focusThumbnailInput,
          onThumbnailInputBlur,
          jsonOutput,
          copyToClipboard,
          toggleTheme,
          zoomIn,
          zoomOut,
          showImportModal,
          hideImportModal,
          importJson
        };
      }
    }).mount('#app');
  </script>
</body>

</html>